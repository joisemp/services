{% extends 'sidebar_base.html' %}

{% load static %}

{% block title %}Issue Management{% endblock %}

{% block styles %}
<link rel="stylesheet" href="{% static 'styles/issue_management/forms/style.css' %}">
<link rel="stylesheet" href="{% static 'styles/components/voice-recorder.css' %}">
<link rel="stylesheet" href="{% static 'styles/components/image-upload.css' %}">
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200">
{% endblock %}

{% block navbar %}
{% include 'navbar.html' %}
{% endblock %}

{% block sidebar %}
{% include 'central_admin/sidebar.html' %}
{% endblock %}

{% block content %}
<div class="container-fluid">
  <h3>Create Issue</h3>
  <form method="post" enctype="multipart/form-data">
    {% csrf_token %}
    <div class="mb-3">
      <label for="{{ form.title.id_for_label }}" class="form-label">Title</label>
      {{ form.title }}
    </div>
    <div class="mb-3">
      <label for="{{ form.description.id_for_label }}" class="form-label">Description</label>
      {{ form.description }}
    </div>
    <div class="mb-3">
      <label for="{{ form.status.id_for_label }}" class="form-label">Status</label>
      {{ form.status }}
    </div>
    <div class="mb-3">
      <label for="{{ form.priority.id_for_label }}" class="form-label">Priority</label>
      {{ form.priority }}
    </div>
    <div class="mb-3">
      <label for="{{ form.org.id_for_label }}" class="form-label">Organization</label>
      {{ form.org }}
    </div>
    <div class="mb-3">
      <label for="{{ form.space.id_for_label }}" class="form-label">Space</label>
      {{ form.space }}
    </div>
    <div class="mb-3 image-upload-section">
      <label class="form-label">
        <span class="material-symbols-outlined me-1" style="font-size: 20px; vertical-align: middle;">image</span>
        Attach Images (Optional - Max 3)
      </label>
      <div class="row">
        <div class="col-md-4">
          <label for="{{ form.image1.id_for_label }}" class="form-label">Image 1</label>
          {{ form.image1 }}
        </div>
        <div class="col-md-4">
          <label for="{{ form.image2.id_for_label }}" class="form-label">Image 2</label>
          {{ form.image2 }}
        </div>
        <div class="col-md-4">
          <label for="{{ form.image3.id_for_label }}" class="form-label">Image 3</label>
          {{ form.image3 }}
        </div>
      </div>
      <small class="form-text text-muted">You can upload up to 3 images. Supported formats: JPG, PNG, GIF. Max size: 5MB per image.</small>
    </div>
    <div class="mb-3">
      <label class="form-label">
        <span class="material-symbols-outlined me-1" style="font-size: 20px; vertical-align: middle;">mic</span>
        Voice Recording (Optional)
      </label>
      <div id="voiceRecorderContainer">
        <!-- Voice recorder will be initialized here by JavaScript -->
      </div>
      {{ form.voice }}
    </div>
    <div class="d-flex">
      <button type="submit" class="btn btn-primary">Create Issue</button>
      <a href="{% url 'issue_management:central_admin:issue_list' %}" class="btn btn-secondary ms-2">Cancel</a>
    </div>
  </form>
</div>
{% endblock %}

{% block scripts %}
<script src="{% static 'js/components/voice-recorder.js' %}"></script>
<script src="{% static 'js/components/image-upload.js' %}"></script>
{% endblock %}